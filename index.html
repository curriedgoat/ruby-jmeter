<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Ruby-JMeter by curriedgoat</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Ruby-JMeter</h1>
      <h2 class="project-tagline">A Ruby based DSL for building JMeter test plans</h2>
      <a href="https://github.com/curriedgoat/ruby-jmeter" class="btn">View on GitHub</a>
      <a href="https://github.com/curriedgoat/ruby-jmeter/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/curriedgoat/ruby-jmeter/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="rubyjmeter" class="anchor" href="#rubyjmeter" aria-hidden="true"><span class="octicon octicon-link"></span></a>RubyJmeter</h1>

<p>Tired of using the JMeter GUI or looking at hairy XML files?</p>

<p>This gem lets you write test plans for JMeter in your favourite text editor, and optionally run them on <a href="http://flood.io">flood.io</a>. </p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>Install it yourself as:</p>

<pre><code>$ gem install ruby-jmeter
</code></pre>

<h2>
<a id="basic-usage" class="anchor" href="#basic-usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Basic Usage</h2>

<p><em>RubyJmeter</em> exposes easy-to-use domain specific language for fluent communication with <a href="http://jmeter.apache.org/">JMeter</a>.It also includes API integration with <a href="https://flood.io">flood.io</a>, a cloud based load testing service.</p>

<p>To use the DSL, first let's require the gem:</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">'</span>rubygems<span class="pl-pds">'</span></span>
<span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">'</span>ruby-jmeter<span class="pl-pds">'</span></span></pre></div>

<h3>
<a id="basic-example" class="anchor" href="#basic-example" aria-hidden="true"><span class="octicon octicon-link"></span></a>Basic Example</h3>

<p>Let's create a <code>test</code> and save the related <code>jmx</code> testplan to file, so we can edit/view it in JMeter.</p>

<div class="highlight highlight-source-ruby"><pre>test <span class="pl-k">do</span>
  threads <span class="pl-c1">count:</span> <span class="pl-c1">10</span> <span class="pl-k">do</span>
    visit <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>Google Search<span class="pl-pds">'</span></span>, <span class="pl-c1">url:</span> <span class="pl-s"><span class="pl-pds">'</span>http://google.com<span class="pl-pds">'</span></span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>.jmx</pre></div>

<p>So in this example, we just created a test plan, with 10 threads, each of which visited the search page at Google. </p>

<h3>
<a id="generating-a-jmeter-test-plan-jmx" class="anchor" href="#generating-a-jmeter-test-plan-jmx" aria-hidden="true"><span class="octicon octicon-link"></span></a>Generating a JMeter Test Plan (JMX)</h3>

<p>Note also how we called the <code>jmx</code> method of the test. Calling this method will write the contents of the JMeter test plan to file like this.</p>

<pre><code>$ ruby testplan.rb
[2013-04-23T10:29:03.275743 #42060]  INFO -- : Test plan saved to: jmeter.jmx
</code></pre>

<div class="highlight highlight-text-xml"><pre>&lt;?<span class="pl-ent">xml</span><span class="pl-e"> version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-e"> encoding</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>?&gt;
&lt;<span class="pl-ent">jmeterTestPlan</span> <span class="pl-e">version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.2<span class="pl-pds">"</span></span> <span class="pl-e">properties</span>=<span class="pl-s"><span class="pl-pds">"</span>2.1<span class="pl-pds">"</span></span>&gt;
  &lt;<span class="pl-ent">hashTree</span>&gt;
    &lt;<span class="pl-ent">TestPlan</span> <span class="pl-e">guiclass</span>=<span class="pl-s"><span class="pl-pds">"</span>TestPlanGui<span class="pl-pds">"</span></span> <span class="pl-e">testclass</span>=<span class="pl-s"><span class="pl-pds">"</span>TestPlan<span class="pl-pds">"</span></span> <span class="pl-e">testname</span>=<span class="pl-s"><span class="pl-pds">"</span>Test Plan<span class="pl-pds">"</span></span> <span class="pl-e">enabled</span>=<span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span>&gt;
      ...
    &lt;/<span class="pl-ent">TestPlan</span>&gt;
  &lt;/<span class="pl-ent">hashTree</span>&gt;
&lt;/<span class="pl-ent">jmeterTestPlan</span>&gt;
JMX saved to: jmeter.jmx</pre></div>

<p>The file that is created can then be executed in the JMeter GUI. If you want to create the file with a different filename and/or path, just add the <code>file</code> parameter to the <code>jmx</code> method call like this.</p>

<div class="highlight highlight-source-ruby"><pre>test <span class="pl-k">do</span>
  threads <span class="pl-c1">count:</span> <span class="pl-c1">10</span> <span class="pl-k">do</span>
    visit <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>Google Search<span class="pl-pds">'</span></span>, <span class="pl-c1">url:</span> <span class="pl-s"><span class="pl-pds">'</span>http://google.com<span class="pl-pds">'</span></span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>.jmx(<span class="pl-c1">file:</span> <span class="pl-s"><span class="pl-pds">"</span>/tmp/my_testplan.jmx<span class="pl-pds">"</span></span>)</pre></div>

<p>Windows users should specify a path like this.</p>

<div class="highlight highlight-source-ruby"><pre>.jmx(<span class="pl-c1">file:</span> <span class="pl-s"><span class="pl-pds">"</span>C:<span class="pl-cce">\\</span>TEMP<span class="pl-cce">\\</span>MyTestplan.jmx<span class="pl-pds">"</span></span>)</pre></div>

<h3>
<a id="running-a-jmeter-test-plan-locally" class="anchor" href="#running-a-jmeter-test-plan-locally" aria-hidden="true"><span class="octicon octicon-link"></span></a>Running a JMeter Test Plan locally</h3>

<p>You can execute the JMeter test plan by calling the <code>run</code> method of the test like this.</p>

<div class="highlight highlight-source-ruby"><pre>test <span class="pl-k">do</span>
  threads <span class="pl-c1">count:</span> <span class="pl-c1">10</span> <span class="pl-k">do</span>
    visit <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>Google Search<span class="pl-pds">'</span></span>, <span class="pl-c1">url:</span> <span class="pl-s"><span class="pl-pds">'</span>http://google.com<span class="pl-pds">'</span></span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>.run</pre></div>

<p>This will launch JMeter in headless (non-GUI mode) and execute the test plan. This is useful for shaking out the script before you push it to the Grid. There are a few parameters that you can set such as the <code>path</code> to the JMeter binary, the <code>file</code> path/name for the JMX file, the <code>log</code> path/name to output JMeter logs and the <code>jtl</code> path/name for JMeter results like this.</p>

<div class="highlight highlight-source-ruby"><pre>test <span class="pl-k">do</span>
  threads <span class="pl-c1">count:</span> <span class="pl-c1">10</span> <span class="pl-k">do</span>
    visit <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>Google Search<span class="pl-pds">'</span></span>, <span class="pl-c1">url:</span> <span class="pl-s"><span class="pl-pds">'</span>http://google.com<span class="pl-pds">'</span></span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span>.run(
  <span class="pl-c1">path:</span> <span class="pl-s"><span class="pl-pds">'</span>/usr/share/jmeter/bin/<span class="pl-pds">'</span></span>, 
  <span class="pl-c1">file:</span> <span class="pl-s"><span class="pl-pds">'</span>jmeter.jmx<span class="pl-pds">'</span></span>, 
  <span class="pl-c1">log:</span> <span class="pl-s"><span class="pl-pds">'</span>jmeter.log<span class="pl-pds">'</span></span>, 
  <span class="pl-c1">jtl:</span> <span class="pl-s"><span class="pl-pds">'</span>results.jtl<span class="pl-pds">'</span></span>)</pre></div>

<h3>
<a id="running-a-jmeter-test-plan-on-floodio" class="anchor" href="#running-a-jmeter-test-plan-on-floodio" aria-hidden="true"><span class="octicon octicon-link"></span></a>Running a JMeter Test Plan on flood.io</h3>

<p>You can also execute JMeter test plans on flood.io using our API. To do so, you require an account and API token. If you don't know your token, sign in to <a href="https://flood.io/api">flood.io</a> and check your account settings.</p>

<p>To execute the test on flood.io, call the <code>grid</code> method on the test and pass it the API token like this.</p>

<div class="highlight highlight-source-ruby"><pre>test <span class="pl-k">do  </span>
  threads <span class="pl-c1">count:</span> <span class="pl-c1">10</span> <span class="pl-k">do</span>
    visit <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>Google Search<span class="pl-pds">'</span></span>, <span class="pl-c1">url:</span> <span class="pl-s"><span class="pl-pds">'</span>http://google.com<span class="pl-pds">'</span></span>
  <span class="pl-k">end</span>  
<span class="pl-k">end</span>.grid(<span class="pl-s"><span class="pl-pds">'</span>OxtZ-4v-v0koSz5Y0enEQQ<span class="pl-pds">'</span></span>)</pre></div>

<p>This will then provide you with a link to the live test results on flood.io like this.</p>

<pre><code>Results at: http://prod.flood.io/shared?testguid=73608030311611e2962f123141011033&amp;run_id=339&amp;tags=jmeter&amp;domain=altentee.com&amp;cluster=54.251.48.129&amp;status=running&amp;view=
</code></pre>

<h2>
<a id="advanced-usage" class="anchor" href="#advanced-usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Advanced Usage</h2>

<h3>
<a id="blocks" class="anchor" href="#blocks" aria-hidden="true"><span class="octicon octicon-link"></span></a>Blocks</h3>

<p>Each of the methods take an optional block delimited by <code>do</code> and <code>end</code> or braces <code>{}</code></p>

<p>Blocks let you nest methods within methods, so you can scope the execution of methods as you would in a normal JMeter test plan. For example.</p>

<div class="highlight highlight-source-ruby"><pre>test <span class="pl-k">do</span>
  threads <span class="pl-c1">count:</span> <span class="pl-c1">100</span> <span class="pl-k">do</span>
    visit <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>Home<span class="pl-pds">'</span></span>, <span class="pl-c1">url:</span> <span class="pl-s"><span class="pl-pds">'</span>http://altentee.com<span class="pl-pds">'</span></span> <span class="pl-k">do</span>
      extract <span class="pl-c1">regex:</span> <span class="pl-s"><span class="pl-pds">"</span>content='(.+?)' name='csrf-token'<span class="pl-pds">"</span></span>, <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>csrf-token<span class="pl-pds">'</span></span>
    <span class="pl-k">end</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>

<p>This would create a new test plan, with a 100 user thread group, each user visiting the "Home" page and extracting the CSRF token from the response of each visit.</p>

<p>All methods are nestable, but you should only have one test method, and typically only one threads method. For example, it wouldn't make sense to have a test plan within a test plan, or a thread group within a thread group. You can have multiple thread groups per test plan though. This implies <em>some</em> knowlege of how JMeter works.</p>

<p>All methods take a parameter hash to configure related options.</p>

<h3>
<a id="threads" class="anchor" href="#threads" aria-hidden="true"><span class="octicon octicon-link"></span></a>Threads</h3>

<p>You can use the <code>threads</code> method to define a group of users:</p>

<div class="highlight highlight-source-ruby"><pre>threads <span class="pl-c1">count:</span> <span class="pl-c1">100</span>
threads <span class="pl-c1">count:</span> <span class="pl-c1">100</span>, <span class="pl-c1">continue_forever:</span> <span class="pl-c1">true</span>
threads <span class="pl-c1">count:</span> <span class="pl-c1">100</span>, <span class="pl-c1">loops:</span> <span class="pl-c1">10</span>
threads <span class="pl-c1">count:</span> <span class="pl-c1">100</span>, <span class="pl-c1">rampup:</span> <span class="pl-c1">30</span>, <span class="pl-c1">duration:</span> <span class="pl-c1">60</span>
threads <span class="pl-c1">count:</span> <span class="pl-c1">100</span>, <span class="pl-c1">scheduler:</span> <span class="pl-c1">true</span>, 
  <span class="pl-c1">start_time:</span> <span class="pl-c1">Time</span>.now.to_i <span class="pl-k">*</span> <span class="pl-c1">1000</span>,
  <span class="pl-c1">end_time:</span>   (<span class="pl-c1">Time</span>.now.to_i <span class="pl-k">*</span> <span class="pl-c1">1000</span>) <span class="pl-k">+</span> (<span class="pl-c1">3600</span> <span class="pl-k">*</span> <span class="pl-c1">1000</span>)</pre></div>

<h3>
<a id="cookies" class="anchor" href="#cookies" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cookies</h3>

<p>You can use the <code>cookies</code> method to define a Cookie Manager:</p>

<div class="highlight highlight-source-ruby"><pre>test <span class="pl-k">do</span>
  cookies
<span class="pl-k">end</span></pre></div>

<p>This methods takes an optional parameters hash. This is based on the <a href="http://jmeter.apache.org/usermanual/component_reference.html#HTTP_Cookie_Manager">HTTP Cookie Manager</a>.</p>

<div class="highlight highlight-source-ruby"><pre>test <span class="pl-k">do</span>
  cookies <span class="pl-c1">clear_each_iteration:</span> <span class="pl-c1">false</span>
<span class="pl-k">end</span>

test <span class="pl-k">do</span>
  cookies <span class="pl-c1">policy:</span> <span class="pl-s"><span class="pl-pds">'</span>rfc2109<span class="pl-pds">'</span></span>, <span class="pl-c1">clear_each_iteration:</span> <span class="pl-c1">true</span>
<span class="pl-k">end</span></pre></div>

<h3>
<a id="cache" class="anchor" href="#cache" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cache</h3>

<p>You can use the <code>cache</code> method to define a Cache Manager:</p>

<div class="highlight highlight-source-ruby"><pre>test <span class="pl-k">do</span>
  cache
<span class="pl-k">end</span></pre></div>

<p>This methods takes an optional parameters hash. This is based on the <a href="http://jmeter.apache.org/usermanual/component_reference.html#HTTP_Cache_Manager">HTTP Cache Manager</a>.</p>

<div class="highlight highlight-source-ruby"><pre>test <span class="pl-k">do</span>
  cache <span class="pl-c1">clear_each_iteration:</span> <span class="pl-c1">false</span>
<span class="pl-k">end</span>

test <span class="pl-k">do</span>
  cache <span class="pl-c1">use_expires:</span> <span class="pl-c1">true</span>, <span class="pl-c1">clear_each_iteration:</span> <span class="pl-c1">true</span>
<span class="pl-k">end</span></pre></div>

<h3>
<a id="authorization" class="anchor" href="#authorization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Authorization</h3>

<p>You can use the <code>auth</code> method to define an Authorization Manager:</p>

<div class="highlight highlight-source-ruby"><pre>test <span class="pl-k">do</span>
  auth
<span class="pl-k">end</span></pre></div>

<p>This methods takes an optional parameters hash. This is based on the <a href="http://jmeter.apache.org/usermanual/component_reference.html#HTTP_Authorization_Manager">HTTP Authorization Manager</a>.</p>

<div class="highlight highlight-source-ruby"><pre>test <span class="pl-k">do</span>
  auth <span class="pl-c1">url:</span> <span class="pl-s"><span class="pl-pds">'</span>/<span class="pl-pds">'</span></span>, <span class="pl-c1">username:</span> <span class="pl-s"><span class="pl-pds">'</span>tim<span class="pl-pds">'</span></span>, <span class="pl-c1">password:</span> <span class="pl-s"><span class="pl-pds">'</span>secret<span class="pl-pds">'</span></span>, <span class="pl-c1">domain:</span> <span class="pl-s"><span class="pl-pds">'</span>altentee.com<span class="pl-pds">'</span></span>
<span class="pl-k">end</span></pre></div>

<h3>
<a id="navigating" class="anchor" href="#navigating" aria-hidden="true"><span class="octicon octicon-link"></span></a>Navigating</h3>

<p>You can use the <code>visit</code> method to navigate to pages:</p>

<div class="highlight highlight-source-ruby"><pre>visit <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>Google Search<span class="pl-pds">'</span></span>, <span class="pl-c1">url:</span> <span class="pl-s"><span class="pl-pds">'</span>http://google.com<span class="pl-pds">'</span></span>
visit <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>Google Search<span class="pl-pds">'</span></span>, <span class="pl-c1">url:</span> <span class="pl-s"><span class="pl-pds">'</span>http://google.com<span class="pl-pds">'</span></span>
visit <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>Google Search<span class="pl-pds">'</span></span>, <span class="pl-c1">url:</span> <span class="pl-s"><span class="pl-pds">'</span>http://google.com<span class="pl-pds">'</span></span>, 
  <span class="pl-c1">method:</span> <span class="pl-s"><span class="pl-pds">'</span>POST<span class="pl-pds">'</span></span>, 
  <span class="pl-s"><span class="pl-pds">'</span>DO_MULTIPART_POST<span class="pl-pds">'</span></span>: <span class="pl-s"><span class="pl-pds">'</span>true<span class="pl-pds">'</span></span>
visit <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>Google Search<span class="pl-pds">'</span></span>, <span class="pl-c1">url:</span> <span class="pl-s"><span class="pl-pds">'</span>http://google.com<span class="pl-pds">'</span></span>,
  <span class="pl-c1">use_keepalive:</span> <span class="pl-s"><span class="pl-pds">'</span>false<span class="pl-pds">'</span></span>
visit <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>Google Search<span class="pl-pds">'</span></span>, <span class="pl-c1">url:</span> <span class="pl-s"><span class="pl-pds">'</span>http://google.com<span class="pl-pds">'</span></span>, 
  <span class="pl-c1">connect_timeout:</span> <span class="pl-s"><span class="pl-pds">'</span>1000<span class="pl-pds">'</span></span>,
  <span class="pl-c1">response_timeout:</span> <span class="pl-s"><span class="pl-pds">'</span>60000<span class="pl-pds">'</span></span>
visit <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>View Login<span class="pl-pds">'</span></span>, <span class="pl-c1">url:</span> <span class="pl-s"><span class="pl-pds">'</span>/login<span class="pl-pds">'</span></span>, 
  <span class="pl-c1">protocol:</span> <span class="pl-s"><span class="pl-pds">"</span>https<span class="pl-pds">"</span></span>,
  <span class="pl-c1">port:</span> <span class="pl-c1">443</span></pre></div>

<h3>
<a id="submitting-a-form" class="anchor" href="#submitting-a-form" aria-hidden="true"><span class="octicon octicon-link"></span></a>Submitting a Form</h3>

<p>You can use the <code>submit</code> method to POST a HTTP form:</p>

<div class="highlight highlight-source-ruby"><pre>submit <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>Submit Form<span class="pl-pds">'</span></span>, <span class="pl-c1">url:</span> <span class="pl-s"><span class="pl-pds">'</span>http://altentee.com/<span class="pl-pds">'</span></span>,
  <span class="pl-c1">fill_in:</span> {
    <span class="pl-c1">username:</span> <span class="pl-s"><span class="pl-pds">'</span>tim<span class="pl-pds">'</span></span>,
    <span class="pl-c1">password:</span> <span class="pl-s"><span class="pl-pds">'</span>password<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>csrf-token<span class="pl-pds">'</span></span> =&gt; <span class="pl-s"><span class="pl-pds">'</span>${csrf-token}<span class="pl-pds">'</span></span>
  }</pre></div>

<p>This method makes a single request. The fill_in parameter lets you specify key/value pairs for form field parameters. You can also use the built in JMeter <code>${expression}</code> language to access run time variables extracted from previous responses.</p>

<h3>
<a id="think-time" class="anchor" href="#think-time" aria-hidden="true"><span class="octicon octicon-link"></span></a>Think Time</h3>

<p>You can use the <code>think_time</code> method to insert pauses into the simulation. This method is aliased as <code>random_timer</code>.</p>

<div class="highlight highlight-source-ruby"><pre>think_time <span class="pl-c1">3000</span></pre></div>

<p>This method takes 2 parameters: the constant delay, and an optional variable delay. Both are specified in milliseconds. This is based on the <a href="http://jmeter.apache.org/usermanual/component_reference.html#Gaussian_Random_Timer">Gaussian Random Timer</a>. This timer pauses each thread request for a random amount of time, with most of the time intervals ocurring near a particular value. The total delay is the sum of the Gaussian distributed value (with mean 0.0 and standard deviation 1.0) times the deviation value you specify, and the offset value.</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># constant delay of 3 seconds</span>
think_time <span class="pl-c1">3000</span>
<span class="pl-c"># constant delay of 1 seconds with variance up to 6 seconds.</span>
random_timer <span class="pl-c1">1000</span>,<span class="pl-c1">5000</span></pre></div>

<h3>
<a id="response-extractor" class="anchor" href="#response-extractor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Response Extractor</h3>

<p>You can use the <code>extract</code> method to extract values from a server response using a regular expression. This is aliased as the <code>web_reg_save_param</code> method. This method is typically used inside a <code>visit</code> or <code>submit</code> block.</p>

<div class="highlight highlight-source-ruby"><pre>extract <span class="pl-c1">regex:</span> <span class="pl-s"><span class="pl-pds">"</span>content='(.+?)' name='csrf-token'<span class="pl-pds">"</span></span>, <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>csrf-token<span class="pl-pds">'</span></span>

visit <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>Google<span class="pl-pds">'</span></span>, <span class="pl-c1">url:</span> <span class="pl-s"><span class="pl-pds">"</span>http://google.com/<span class="pl-pds">"</span></span> <span class="pl-k">do</span>
  extract <span class="pl-c1">regex:</span> <span class="pl-s"><span class="pl-pds">'</span>aria-label="(.+?)"<span class="pl-pds">'</span></span>, <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>button_text<span class="pl-pds">'</span></span>
  extract <span class="pl-c1">xpath:</span> <span class="pl-s"><span class="pl-pds">'</span>//button<span class="pl-pds">'</span></span>, <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>button<span class="pl-pds">'</span></span>
<span class="pl-k">end</span></pre></div>

<p>This is based on the <a href="http://jmeter.apache.org/usermanual/component_reference.html#Regular_Expression_Extractor">Regular Expression Extractor</a> and <a href="http://jmeter.apache.org/usermanual/component_reference.html#XPath_Extractor">XPath Extractor</a></p>

<div class="highlight highlight-source-ruby"><pre>visit <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">"</span>Altentee<span class="pl-pds">"</span></span>, <span class="pl-c1">url:</span> <span class="pl-s"><span class="pl-pds">"</span>http://altentee.com<span class="pl-pds">"</span></span> <span class="pl-k">do</span>
  extract <span class="pl-c1">regex:</span> <span class="pl-s"><span class="pl-pds">"</span>content='(.+?)' name='csrf-token'<span class="pl-pds">"</span></span>, <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>csrf-token<span class="pl-pds">'</span></span>
  extract <span class="pl-c1">regex:</span> <span class="pl-s"><span class="pl-pds">'</span>value="(.+?)" name="JESSIONSID"<span class="pl-pds">'</span></span>, <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>JSESSIONID<span class="pl-pds">'</span></span>
  web_reg_save_param <span class="pl-c1">regex:</span> <span class="pl-s"><span class="pl-pds">'</span>value="(.+?)" name="VIEWSTATE"<span class="pl-pds">'</span></span>, <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>VIEWSTATE<span class="pl-pds">'</span></span>
  extract <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>username<span class="pl-pds">'</span></span>, <span class="pl-c1">regex:</span> <span class="pl-s"><span class="pl-pds">'</span>value="(.+?)", name="username"<span class="pl-pds">'</span></span>, 
    <span class="pl-c1">default:</span> <span class="pl-s"><span class="pl-pds">'</span>Tim Koopmans<span class="pl-pds">'</span></span>,
    <span class="pl-c1">match_number:</span> <span class="pl-c1">1</span>
  extract <span class="pl-c1">name:</span> <span class="pl-s"><span class="pl-pds">'</span>shopping_item<span class="pl-pds">'</span></span>, <span class="pl-c1">regex:</span> <span class="pl-s"><span class="pl-pds">'</span>id="(.+?)" name="book"<span class="pl-pds">'</span></span>, 
    <span class="pl-c1">match_number:</span> <span class="pl-c1">0</span> <span class="pl-c"># random</span>
<span class="pl-k">end</span></pre></div>

<h3>
<a id="response-assertion" class="anchor" href="#response-assertion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Response Assertion</h3>

<p>You can use the <code>assert</code> method to extract values from a server response using a regular expression. This is aliased as the <code>web_reg_find</code> method. This method is typically used inside a <code>visit</code> or <code>submit</code> block.</p>

<div class="highlight highlight-source-ruby"><pre>visit <span class="pl-s"><span class="pl-pds">"</span>Altentee<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>http://altentee.com<span class="pl-pds">"</span></span> <span class="pl-k">do</span>
  assert <span class="pl-c1">contains:</span> <span class="pl-s"><span class="pl-pds">"</span>We test, tune and secure your site<span class="pl-pds">"</span></span>
<span class="pl-k">end</span></pre></div>

<p>This method takes 3 parameters: the matching rule, the test string, and an optional parameters hash. This is based on the <a href="http://jmeter.apache.org/usermanual/component_reference.html#Response_Assertion">Response Assertion</a>. </p>

<div class="highlight highlight-source-ruby"><pre>visit <span class="pl-s"><span class="pl-pds">"</span>Altentee<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>http://altentee.com<span class="pl-pds">"</span></span> <span class="pl-k">do</span>
  assert <span class="pl-s"><span class="pl-pds">"</span>contains<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>We test, tune and secure your site<span class="pl-pds">"</span></span>
  assert <span class="pl-s"><span class="pl-pds">"</span>not-contains<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>We price gouge on cloud services<span class="pl-pds">"</span></span>
  assert <span class="pl-s"><span class="pl-pds">"</span>matches<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>genius<span class="pl-pds">"</span></span>
  assert <span class="pl-s"><span class="pl-pds">"</span>not-matches<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>fakers<span class="pl-pds">"</span></span>
  assert <span class="pl-s"><span class="pl-pds">"</span>contains<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>magic<span class="pl-pds">"</span></span>
  assert <span class="pl-s"><span class="pl-pds">"</span>not-contains<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>unicorns<span class="pl-pds">"</span></span>, <span class="pl-c1">scope:</span> <span class="pl-s"><span class="pl-pds">'</span>all<span class="pl-pds">'</span></span>
<span class="pl-k">end</span></pre></div>

<h2>
<a id="roadmap" class="anchor" href="#roadmap" aria-hidden="true"><span class="octicon octicon-link"></span></a>Roadmap</h2>

<p>This work is being sponsored by flood.io. Get in touch with us if you'd like to be involved.</p>

<h2>
<a id="contributing" class="anchor" href="#contributing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contributing</h2>

<ol>
<li>Fork it</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Create some specs, make them pass</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create new Pull Request</li>
</ol>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/curriedgoat/ruby-jmeter">Ruby-JMeter</a> is maintained by <a href="https://github.com/curriedgoat">curriedgoat</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-42892720-2");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
